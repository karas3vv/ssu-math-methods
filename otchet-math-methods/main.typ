#import "conf.typ" : conf
#show: conf.with(
  title: [–û—Ç—á—ë—Ç\ –ø–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ],
  type: "pract",
  info: (
      author: (
        name: [–ö–∞—Ä–∞—Å–µ–≤–∞ –í–∞–¥–∏–º–∞ –î–º–∏—Ç—Ä–∏–µ–≤–∏—á–∞],
        faculty: [–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –Ω–∞—É–∫ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π],
        group: "351",
        sex: "male"
      ),
      inspector: (
        degree: "",
        name: ""
      )
  ),
  settings: (
    title_page: (
      enabled: true
    ),
    contents_page: (
      enabled: false
    )
  )
)

= –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –≤ –æ–±—â–µ–º –≤–∏–¥–µ

*–£—Å–ª–æ–≤–∏–µ*

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω –≤ –æ–±—â–µ–º –≤–∏–¥–µ.

#table(rows: 2, columns: (1fr, 1fr, 1fr, 1fr, 1fr))[*$x$*][
  0][1][2][3][*$f(x)$*][2][3][10][29]

*–ö–æ–¥*

```python 
import numpy
# –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
x_data = [0, 1, 2, 3]
f_data = [2, 3, 10, 29]
x_np_data = numpy.array(x_data)
f_np_data = numpy.array(f_data)
print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
for i in range (0, 4):
    print('X' + str(i) + ': ' + str(x_data[i]) + '\tF' + str(i) + ': ' + str(f_data[i]))
# —Å—Ç–æ—Ä–∏–º –º–∞—Ç—Ä–∏—Ü—É
matrix = numpy.vander(x_np_data, len(x_data), increasing=True)
matrix_flipped = numpy.flip(matrix, axis=1)
print("\n–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞:")
for i in range(0, 4):
    s = ""
    for j in range (0, 4):
        s += str(matrix_flipped[i][j]) + ' * a' + str(4 - j - 1) + ' + '
    print(s[:-2] + ' = ' + str(f_data[i]))
print()
# —Ä–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —É—Ä–∞–≤–Ω–µ–Ω–∏–π –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞
coefficients = numpy.linalg.solve(matrix, f_np_data)
print("\n–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã:")
for i in range (0, 4):
    print('a' + str(i) + ': ' + str(coefficients[i]))
print("\nP3 (x): ")
for i in range (0, 7):
    print('x = ' + str(i / 2) + ': ' + str(
        coefficients[3] * (i / 2) * (i / 2) * (i / 2)
        + coefficients[2] * (i / 2) * (i / 2)
        + coefficients[1] * (i / 2)
        + coefficients[0]
        ))
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
X0: 0   F0: 2
X1: 1   F1: 3
X2: 2   F2: 10
X3: 3   F3: 29
–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞:
0 * a3 + 0 * a2 + 0 * a1 + 1 * a0  = 2
1 * a3 + 1 * a2 + 1 * a1 + 1 * a0  = 3
8 * a3 + 4 * a2 + 2 * a1 + 1 * a0  = 10
27 * a3 + 9 * a2 + 3 * a1 + 1 * a0  = 29
```
```
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã:
a0: 2.0
a1: 0.0
a2: -0.0
a3: 1.0
P3 (x): 
x = 0.0: 2.0
x = 0.5: 2.125
x = 1.0: 3.0
x = 1.5: 5.375
x = 2.0: 10.0
x = 2.5: 17.625
x = 3.0: 29.0
```

= –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω –≤ —Ñ–æ—Ä–º–µ –õ–∞–≥—Ä–∞–Ω–∂–∞

*–£—Å–ª–æ–≤–∏–µ*

–ü–æ –¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω
–≤ —Ñ–æ—Ä–º–µ –õ–∞–≥—Ä–∞–Ω–∂–∞.

#table(rows: 2, columns: (1fr, 1fr, 1fr, 1fr, 1fr))[*$x$*][
  0][1][2][3][*$f(x)$*][2][3][10][29]

*–ö–æ–¥*
```python 
import numpy
def lagrange_fundamental(k, x_nodes, z):
        Lk = 1.0
        for i, xi in enumerate(x_nodes):
            if i != k:
                Lk *= (z - xi) / (x_nodes[k] - xi)
        return Lk

def lagrange_interpolation(x_nodes, y_nodes, z):
        P = 0.0
        for k in range(len(x_nodes)):
            P += y_nodes[k] * lagrange_fundamental(k, x_nodes, z)
        return P
x_data = [0, 1, 2, 3]
f_data = [2, 3, 10, 29]
x_np_data = numpy.array(x_data)
f_np_data = numpy.array(f_data)
print("–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
for i in range (0, 4):
    print('X' + str(i) + ': ' + str(x_data[i]) + '\tF' + str(i) + ': ' + str(f_data[i]))  
print("\nL3 (x): ")
for i in range (0, 7):
    print('x = ' + str(i / 2) + ': ' + str(
        lagrange_interpolation(x_data, f_data, i / 2)
        ))
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
X0: 0   F0: 2
X1: 1   F1: 3
X2: 2   F2: 10
X3: 3   F3: 29
L3 (x): 
x = 0.0: 2.0
x = 0.5: 2.125
x = 1.0: 3.0
x = 1.5: 5.375
x = 2.0: 10.0
x = 2.5: 17.625
x = 3.0: 29.0
```

= –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω –≤ —Ñ–æ—Ä–º–µ –ù—å—é—Ç–æ–Ω–∞

*–£—Å–ª–æ–≤–∏–µ*

–ü–æ –¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω
–≤ —Ñ–æ—Ä–º–µ –ù—å—é—Ç–æ–Ω–∞.

#table(rows: 2, columns: (1fr, 1fr, 1fr, 1fr, 1fr))[*$x$*][
  0][1][2][3][*$f(x)$*][2][3][10][29]

*–ö–æ–¥*

```python
import numpy as np
import pandas as pd
# –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
x_data = np.array([0, 1, 2, 3])
f_data = np.array([2, 3, 10, 29])
print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(pd.DataFrame({'X': x_data, 'F': f_data}))
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∑–Ω–æ—Å—Ç–µ–π
def divided_difference_table(x, y):
    n = len(x)
    table = np.zeros((n, n))
    table[:,0] = y
    for j in range(1, n):
        for i in range(n - j):
            table[i,j] = (table[i+1,j-1] - table[i,j-1]) / (x[i+j] - x[i])
    return table
dd_table = divided_difference_table(x_data, f_data)
# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∑–Ω–æ—Å—Ç–µ–π
dd_df = pd.DataFrame(dd_table, columns=[f"f[x0..x{j}]" for j in range(len(x_data))])
print("\n–¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∑–Ω–æ—Å—Ç–µ–π (–º–∞—Ç—Ä–∏—Ü–∞ –ù—å—é—Ç–æ–Ω–∞):")
print(dd_df)
# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ù—å—é—Ç–æ–Ω–∞ (–≤–µ—Ä—Ö–Ω—è—è —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã)
newton_coeffs = dd_table[0,:]
print("\n–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –ù—å—é—Ç–æ–Ω–∞:")
print(newton_coeffs)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –ù—å—é—Ç–æ–Ω–∞
def newton_polynomial(x, coeffs, x_data):
    n = len(coeffs) - 1
    p = coeffs[n]
    for k in range(1, n + 1):
        p = coeffs[n-k] + (x - x_data[n-k]) * p
    return p
```
```
# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö
x_half = [(x_data[i] + x_data[i+1])/2 for i in range(len(x_data)-1)]
f_half_newton = [newton_polynomial(x, newton_coeffs, x_data) for x in x_half]
# –û–±—ä–µ–¥–∏–Ω—è–µ–º —É–∑–ª—ã –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏
x_combined = np.concatenate([x_data, x_half])
y_newton = np.concatenate([f_data, f_half_newton])
# –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ X
sort_idx = np.argsort(x_combined)
x_combined = x_combined[sort_idx]
y_newton = y_newton[sort_idx]
# –°–æ–∑–¥–∞–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É
newton_df = pd.DataFrame({
    'X': x_combined,
    'F (–ù—å—é—Ç–æ–Ω)': y_newton
})
print("\n–ó–Ω–∞—á–µ–Ω–∏—è –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –ù—å—é—Ç–æ–Ω–∞:")
print(newton_df.to_string(index=False))
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
   X   F
0  0   2
1  1   3
2  2  10
3  3  29
–¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∑–Ω–æ—Å—Ç–µ–π (–º–∞—Ç—Ä–∏—Ü–∞ –ù—å—é—Ç–æ–Ω–∞):
   f[x0..x0]  f[x0..x1]  f[x0..x2]  f[x0..x3]
0        2.0        1.0        3.0        1.0
1        3.0        7.0        6.0        0.0
2       10.0       19.0        0.0        0.0
3       29.0        0.0        0.0        0.0
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –ù—å—é—Ç–æ–Ω–∞:
[2. 1. 3. 1.]
–ó–Ω–∞—á–µ–Ω–∏—è –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ –ù—å—é—Ç–æ–Ω–∞:
  X  F (–ù—å—é—Ç–æ–Ω)
0.0       2.000
0.5       2.125
1.0       3.000
1.5       5.375
2.0      10.000
2.5      17.625
3.0      29.000
```

= –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –∫—É–±–∏—á–µ—Å–∫–∏–º–∏ —Å–ø–ª–∞–π–Ω–∞–º–∏

*–£—Å–ª–æ–≤–∏–µ*

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω —Å –ø–æ–º–æ—â—å—é –∫—É–±–∏—á–µ—Å–∫–∏—Ö —Å–ø–ª–∞–π–Ω–æ–≤
(–∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏—Ö –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ —Ç—Ä–µ—Ç—å–µ–π —Å—Ç–µ–ø–µ–Ω–∏, –≥–¥–µ —Å–ø–ª–∞–π–Ω --- —Ñ—Ä–∞–≥–º–µ–Ω—Ç, –æ—Ç—Ä–µ–∑–æ–∫ —á–µ–≥–æ-–ª–∏–±–æ).

#table(rows: 2, columns: (1fr, 1fr, 1fr, 1fr, 1fr))[*$x$*][
  0][1][2][3][*$f(x)$*][2][3][10][29]

*–ö–æ–¥*

```python
import numpy as np
import pandas as pd
def create_spline_matrix(x, f):
    n = len(x) - 1  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
    # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É 12x12 –∏ –≤–µ–∫—Ç–æ—Ä –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏
    a = np.zeros((4*n, 4*n))
    b = np.zeros(4*n)
    # —É—Ä–∞–≤–Ω–µ–Ω–∏–µ 1: –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –≤ –ª–µ–≤—ã—Ö –∫–æ–Ω—Ü–∞—Ö
    # s_i(x_i) = f_i
    for i in range(n):
        row = i
        a[row, 4*i] = 1  # a_i
        b[row] = f[i]
    # —É—Ä–∞–≤–Ω–µ–Ω–∏–µ 2: –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –≤ –ø—Ä–∞–≤—ã—Ö –∫–æ–Ω—Ü–∞—Ö
    # s_i(x_{i+1}) = f_{i+1}
    for i in range(n):
        row = n + i
        h = x[i+1] - x[i]
        a[row, 4*i] = 1          # a_i
        a[row, 4*i + 1] = h      # b_i
        a[row, 4*i + 2] = h**2   # c_i
        a[row, 4*i + 3] = h**3   # d_i
        b[row] = f[i+1]
    # —É—Ä–∞–≤–Ω–µ–Ω–∏–µ 3: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–≤—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö
    # s'_i(x_{i+1}) = s'_{i+1}(x_{i+1})
    for i in range(n-1):
        row = 2*n + i
        h_i = x[i+1] - x[i]
        h_ip1 = x[i+2] - x[i+1]
        a[row, 4*i + 1] = 1          # b_i
        a[row, 4*i + 2] = 2*h_i      # 2*c_i*h_i
        a[row, 4*i + 3] = 3*h_i**2   # 3*d_i*h_i^2
        a[row, 4*(i+1) + 1] = -1     # -b_{i+1}
        b[row] = 0
    # —É—Ä–∞–≤–Ω–µ–Ω–∏–µ 4: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö
    # s''_i(x_{i+1}) = s''_{i+1}(x_{i+1})
    for i in range(n-1):
        row = 3*n - 1 + i
        h_i = x[i+1] - x[i]
        a[row, 4*i + 2] = 2         # 2*c_i
        a[row, 4*i + 3] = 6*h_i     # 6*d_i*h_i
        a[row, 4*(i+1) + 2] = -2    # -2*c_{i+1}
        b[row] = 0
    # –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–ª–∞–π–Ω)
    # s''_0(x_0) = 0 –∏ s''_{n-1}(x_n) = 0
    row1 = 4*n - 2
    a[row1, 2] = 2  # 2*c_0 = 0
    row2 = 4*n - 1
    h_last = x[n] - x[n-1]
    a[row2, 4*(n-1) + 2] = 2         # 2*c_{n-1}
    a[row2, 4*(n-1) + 3] = 6*h_last  # 6*d_{n-1}*h_{n-1}
    return a, b
def solve_spline_coefficients(x, f):
    a, b = create_spline_matrix(x, f)
    coefficients = np.linalg.solve(a, b)
    return coefficients.reshape(-1, 4)  # –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –º–∞—Ç—Ä–∏—Ü—É [n x 4]
# –¥–∞–Ω–Ω—ã–µ –∏–∑ —É—Å–ª–æ–≤–∏—è
x = np.array([0, 1, 2, 3])
f = np.array([2, 3, 10, 29])
# —Å–æ–∑–¥–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É –∏ —Ä–µ—à–∞–µ–º —Å–∏—Å—Ç–µ–º—É
a, b = create_spline_matrix(x, f)
coefficients = solve_spline_coefficients(x, f)
```
```
# —Å–æ–∑–¥–∞–µ–º dataframe –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã
matrix_df = pd.DataFrame(a, 
                        columns=[f'coef_{i}' for i in range(12)],
                        index=[f'eq_{i}' for i in range(12)])
# –≤—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print("–ú–∞—Ç—Ä–∏—Ü–∞ —Å–∏—Å—Ç–µ–º—ã 12x12:")
print(matrix_df)
print("\n–í–µ–∫—Ç–æ—Ä –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏:")
print(pd.Series(b, index=[f'eq_{i}' for i in range(12)]))
print("\n–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å–ø–ª–∞–π–Ω–æ–≤ (–ø–æ —Å—Ç—Ä–æ–∫–∞–º: [a_i, b_i, c_i, d_i] –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞):")
print(pd.DataFrame(coefficients, 
                  columns=['a_i', 'b_i', 'c_i', 'd_i'],
                  index=[f'interval {i}' for i in range(len(x)-1)]))
# –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏
print(f"\n–†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã: {a.shape}")
print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤: {len(x)-1}")
```

*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
–ú–∞—Ç—Ä–∏—Ü–∞ —Å–∏—Å—Ç–µ–º—ã 12x12:
    coef_0 coef_1 coef_2 coef_3  coef_4  coef_5 coef_6  coef_7  coef_8  coef_9  coef_10 coef_11
eq_0  1.0    0.0    0.0    0.0     0.0     0.0    0.0     0.0     0.0     0.0     0.0    0.0
eq_1  0.0    0.0    0.0    0.0     1.0     0.0    0.0     0.0     0.0     0.0     0.0    0.0
eq_2  0.0    0.0    0.0    0.0     0.0     0.0    0.0     0.0     1.0     0.0     0.0    0.0
eq_3  1.0    1.0    1.0    1.0     0.0     0.0    0.0     0.0     0.0     0.0     0.0    0.0
eq_4  0.0    0.0    0.0    0.0     1.0     1.0    1.0     1.0     0.0     0.0     0.0    0.0
eq_5  0.0    0.0    0.0    0.0     0.0     0.0    0.0     0.0     1.0     1.0     1.0    1.0
eq_6  0.0    1.0    2.0    3.0     0.0    -1.0    0.0     0.0     0.0     0.0     0.0    0.0
eq_7  0.0    0.0    0.0    0.0     0.0     1.0    2.0     3.0     0.0    -1.0     0.0    0.0
eq_8  0.0    0.0    2.0    6.0     0.0     0.0   -2.0     0.0     0.0     0.0     0.0    0.0
eq_9  0.0    0.0    0.0    0.0     0.0     0.0    2.0     6.0     0.0     0.0    -2.0    0.0
eq_10 0.0    0.0    2.0    0.0     0.0     0.0    0.0     0.0     0.0     0.0     0.0    0.0
eq_11 0.0    0.0    0.0    0.0     0.0     0.0    0.0     0.0     0.0     0.0     2.0    6.0
–í–µ–∫—Ç–æ—Ä –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏:
eq_0      2.0
eq_1      3.0
eq_2     10.0
eq_3      3.0
eq_4     10.0
eq_5     29.0
eq_6      0.0
eq_7      0.0
eq_8      0.0
eq_9      0.0
eq_10     0.0
eq_11     0.0
```
```
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å–ø–ª–∞–π–Ω–æ–≤ (–ø–æ —Å—Ç—Ä–æ–∫–∞–º: [a_i, b_i, c_i, d_i] –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞):
             a_i   b_i  c_i  d_i
interval 0   2.0   0.2  0.0  0.8
interval 1   3.0   2.6  2.4  2.0
interval 2  10.0  13.4  8.4 -2.8
–†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã: (12, 12)
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤: 3
```
= –ú–µ—Ç–æ–¥ –ì–∞—É—Å—Å–∞ —Ä–µ—à–µ–Ω–∏—è –°–õ–ê–£

*–£—Å–ª–æ–≤–∏–µ*

–†–µ—à–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –°–õ–ê–£ –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å—Å–∞
–ú–µ—Ç–æ–¥ –ì–∞—É—Å—Å–∞ –¥–æ–ª–∂–µ–Ω —Ä–µ—à–∞—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è –≤–∏–¥–∞ $A x = b$, –≥–¥–µ $A$ - –º–∞—Ç—Ä–∏—Ü–∞.
–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü–∞ $–ê$ –ø—Ä–∏–º–µ—Ç –≤–∏–¥:

$
  A = mat(5, 0.05, 0.05, 0.05, 0.05;
      0.06, 6, 0.06, 0.06, 0.06;
      0.07, 0.07, 7, 0.07, 0.07;
      0.08, 0.08, 0.08, 8, 0.08;
      0.09, 0.09, 0.09, 0.09, 9) quad
  b = mat(5;6;7;8;9).
$

*–ö–æ–¥*
```python 
import numpy as np
A = np.array([[5, 0.05, 0.05, 0.05, 0.05],
             [0.06, 6, 0.06, 0.06, 0.06],
             [0.07, 0.07, 7, 0.07, 0.07],
             [0.08, 0.08, 0.08, 8, 0.08,],
             [0.09, 0.09, 0.09, 0.09, 9]])
print("1) –ú–∞—Ç—Ä–∏—Ü–∞ A:\n", A)
print("–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –º–∞—Ç—Ä–∏—Ü—ã A = ", np.linalg.det(A))
b = np.zeros(len(A))
print("\n–ö–æ–ª–æ–Ω–∫–∞ b:")
for i in range(len(A)):
    b[i] = A[i][i]
    print("[", b[i], "]")
def forward_elimination(A, b):
    n = len(b)
    for k in range(n - 1):
        for i in range(k + 1, n):
            if A[i, k] != 0:
                factor = A[i, k] / A[k, k]
                A[i, k+1:n] = A[i, k+1:n] - factor * A[k, k+1:n]
                A[i, k] = 0  # Explicitly zero out for clarity
                b[i] = b[i] - factor * b[k]
    return A, b
A_tmp, b_tmp = forward_elimination(A, b)
print("–ú–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Å–ª–µ –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞:")
print(A_tmp)
def backward_substitution(U, b):
    n = len(b)
    x = np.zeros(n)
    for i in range(n-1, -1, -1):
        x[i] = b[i] - np.dot(U[i, i+1:], x[i+1:])
        x[i] /= U[i, i]
    return x
```
```
solution = backward_substitution(A_tmp, b_tmp)
print("–†–µ—à–µ–Ω–∏–µ (A|b) –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å—Å–∞")
print("–í–µ–∫—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞: ")
for i in range(len(solution)):
    print("x", str(i), "=", solution[i])
print(solution, "\n 4) x =")
for i in range(len(solution)):
    print("[", solution[i], "]")
b = np.dot(A, b)
```

*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
1) –ú–∞—Ç—Ä–∏—Ü–∞ A:
 [[5.   0.05 0.05 0.05 0.05]
 [0.06 6.   0.06 0.06 0.06]
 [0.07 0.07 7.   0.07 0.07]
 [0.08 0.08 0.08 8.   0.08]
 [0.09 0.09 0.09 0.09 9.  ]]
–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –º–∞—Ç—Ä–∏—Ü—ã A =  15105.180138048006
–ö–æ–ª–æ–Ω–∫–∞ b:
[ 5.0 ]
[ 6.0 ]
[ 7.0 ]
[ 8.0 ]
[ 9.0 ]
–ú–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Å–ª–µ –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞:
[[5.         0.05       0.05       0.05       0.05      ]
 [0.         5.9994     0.0594     0.0594     0.0594    ]
 [0.         0.         6.99861386 0.06861386 0.06861386]
 [0.         0.         0.         7.99764706 0.07764706]
 [0.         0.         0.         0.         8.99650485]]
–†–µ—à–µ–Ω–∏–µ (A|b) –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å—Å–∞
–í–µ–∫—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞: 
x 0 = 0.9615384615384615
x 1 = 0.9615384615384616
x 2 = 0.9615384615384616
x 3 = 0.9615384615384616
x 4 = 0.9615384615384612
[0.96153846 0.96153846 0.96153846 0.96153846 0.96153846] 
 4) x =
[ 0.9615384615384615 ]
[ 0.9615384615384616 ]
[ 0.9615384615384616 ]
[ 0.9615384615384616 ]
[ 0.9615384615384612 ]
```

=	–ú–µ—Ç–æ–¥ –ø—Ä–æ–≥–æ–Ω–∫–∏ —Ä–µ—à–µ–Ω–∏—è –°–õ–ê–£ (—Ç—Ä–µ—Ö–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã—Ö)

*–£—Å–ª–æ–≤–∏–µ*
–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ä–µ—à–∞–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π –≤–∏–¥–∞ $A x = b$, –≥–¥–µ $A$ --- –º–∞—Ç—Ä–∏—Ü–∞ –≤–∏–¥–∞:
$
    mat(5, 0.05, 0.05, 0.05, 0.05;
      0.06, 6, 0.06, 0.06, 0.06;
      0.07, 0.07, 7, 0.07, 0.07;
      0.08, 0.08, 0.08, 8, 0.08;
      0.09, 0.09, 0.09, 0.09, 9) quad
  b = mat(5;6;7;8;9).
$
*–ö–æ–¥*
```python 
import numpy as np
A = np.array([[5, 0.05, 0, 0, 0],
              [0.06, 6, 0.06, 0, 0.],
              [0, 0.07, 7, 0.07, 0],
              [0, 0, 0.08, 8, 0.08],
              [0, 0, 0, 0.09, 9]])
# –í—ã—á–∏—Å–ª—è–µ–º –≤–µ–∫—Ç–æ—Ä b
b = np.zeros(len(A))
for i in range(len(A)):
    b[i] = A[i][i]
b = np.dot(A, b.reshape(-1,1))
```
```
print("–ú–∞—Ç—Ä–∏—Ü–∞ A:")
print(A)
print("–°—Ç–æ–ª–±–µ—Ü b:")
print(b)
Q = np.zeros(len(A))
P = np.zeros(len(A) - 1)
P[0] = -A[0][1]/A[0][0]
Q[0] = b[0][0]/A[0][0]
print("–ü—Ä—è–º–∞—è –ø—Ä–æ–≥–æ–Ω–∫–∞")
print("–°–ø–∏—Å–æ–∫ Pi –∏ Qi")
for i in range(1, len(P)):
    P[i] = (A[i][i+1])/(-A[i][i] - A[i][i-1] * P[i-1])
for i in range(1, len(Q)):
    Q[i] = (A[i][i-1] * Q[i-1] - b[i][0]) / (-A[i][i] - A[i][i-1] * P[i-1])
print(P, Q)
print("–û–±—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–≥–æ–Ω–∫–∞")
x = np.zeros(len(A))
x[len(A)-1] = Q[len(A)-1]
print("x 5 =",x[len(A)-1])
for i in range(len(x) - 2, -1, -1):
    x[i] = P[i] * x[i + 1] + Q[i]
    print("x",i + 1,"= ", x[i])
print(x.reshape(-1,1))
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
–ú–∞—Ç—Ä–∏—Ü–∞ A:
[[5.   0.05 0.   0.   0.  ]
 [0.06 6.   0.06 0.   0.  ]
 [0.   0.07 7.   0.07 0.  ]
 [0.   0.   0.08 8.   0.08]
 [0.   0.   0.   0.09 9.  ]]
–°—Ç–æ–ª–±–µ—Ü b:
[[25.3 ]
 [36.72]
 [49.98]
 [65.28]
 [81.72]]
–ü—Ä—è–º–∞—è –ø—Ä–æ–≥–æ–Ω–∫–∞
–°–ø–∏—Å–æ–∫ Pi –∏ Qi
[-0.01 -0.010001 -0.010001 -0.010001] [5.06 6.070007 7.080008 8.090009 9.]

–û–±—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–≥–æ–Ω–∫–∞
x 5 = 9.0
x 4 =  8.000000000000002
x 3 =  6.999999999999999
x 2 =  6.0
x 1 =  5.000000000000001
```
```
[[5.]
 [6.]
 [7.]
 [8.]
 [9.]]
```

= –ú–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏

*–£—Å–ª–æ–≤–∏–µ*

–ü—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –°–õ–ê–£ –≤–∏–¥–∞ $A x = b$, –≥–¥–µ $A$ --- –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, –º—ã –º–æ–∂–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –µ–µ –∫ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ–º—É –≤–∏–¥—É:

$
  mat(0, - a_12/a_11, ..., -a_(1 n) / a_11;
      -a_21/a_22, 0, ..., -a_(2 n)/a_22;
      dots.v, dots.v, dots.down, dots.v;
    -a_(n 1)/a_(n n), -a_(n 2)/a_(n n), ..., 0
    )
  x = mat(b_1 / a_11; b_2 / a_22; dots.v; b_n / a_(n n)).
$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∏—Å—Ö–æ–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ø—É—Å–∫–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤ –≤–∏–¥–µ:

$
 alpha x + beta = x,
$

–∞ –∫—Ä–∏—Ç–µ—Ä–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π:

$
  ||x^(k) - x^(k-1)|| < e.
$

*–ö–æ–¥*

```python 
import numpy as np
A = np.array([[5, 0.05, 0.05, 0.05, 0.05],
             [0.06, 6, 0.06, 0.06, 0.06],
             [0.07, 0.07, 7, 0.07, 0.07],
             [0.08, 0.08, 0.08, 8, 0.08,],
             [0.09, 0.09, 0.09, 0.09, 9]])
print("–ú–∞—Ç—Ä–∏—Ü–∞ A:")
print(A)
print("–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –º–∞—Ç—Ä–∏—Ü—ã A:", np.linalg.det(A))
# –í—ã—á–∏—Å–ª—è–µ–º –≤–µ–∫—Ç–æ—Ä b
b = np.zeros(len(A))
for i in range(len(A)):
    b[i] = A[i][i]
b = np.dot(A, b.reshape(-1,1))
print("–°—Ç–æ–ª–±–µ—Ü b:")
print(b)
alpha = A.copy()
beta = b.copy()
for i in range(len(A)):
    for j in range(len(A)):
        if i == j:
            alpha[i][j] = 0
        else:
            alpha[i][j] = - A[i][j]/A[i][i]
print("–ú–∞—Ç—Ä–∏—Ü–∞ alpha:")
print(alpha)
for i in range(len(A)):
    beta[i][0] = b[i][0]/A[i][i]
print("–°—Ç–æ–ª–±–µ—Ü beta:")
print(beta)
epsilon = 10**-9
print("–°—á–∏—Ç–∞–µ–º –¥–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ epsilon=", epsilon)
xk = np.zeros(len(A)).reshape(-1,1)
print("x^(0) = ", xk)
def normStop (xk, xkp1, epsilon):
    return max(np.abs(np.add(xk, -xkp1))) < epsilon
```
```
for i in range(17):
    xkp1 = np.add(np.dot(alpha, xk), beta) 
    print(f"x^({i+1})=", xkp1)
    if normStop(xk, xkp1, epsilon):
        break
    xk = xkp1
```

*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
–ú–∞—Ç—Ä–∏—Ü–∞ A:
[[5.   0.05 0.05 0.05 0.05]
 [0.06 6.   0.06 0.06 0.06]
 [0.07 0.07 7.   0.07 0.07]
 [0.08 0.08 0.08 8.   0.08]
 [0.09 0.09 0.09 0.09 9.  ]]
–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –º–∞—Ç—Ä–∏—Ü—ã A: 15105.180138048006
–°—Ç–æ–ª–±–µ—Ü b:
[[26.5 ]
 [37.74]
 [50.96]
 [66.16]
 [83.34]]
–ú–∞—Ç—Ä–∏—Ü–∞ alpha:
[[ 0.   -0.01 -0.01 -0.01 -0.01]
 [-0.01  0.   -0.01 -0.01 -0.01]
 [-0.01 -0.01  0.   -0.01 -0.01]
 [-0.01 -0.01 -0.01  0.   -0.01]
 [-0.01 -0.01 -0.01 -0.01  0.  ]]
–°—Ç–æ–ª–±–µ—Ü beta:
[[5.3 ]
 [6.29]
 [7.28]
 [8.27]
 [9.26]]
–°—á–∏—Ç–∞–µ–º –¥–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ epsilon= 1e-09
x^(0) =  [[0.]
 [0.]
 [0.]
 [0.]
 [0.]]
x^(1)= [[5.3 ]
 [6.29]
 [7.28]
 [8.27]
 [9.26]]
x^(2)= [[4.989 ]
 [5.9889]
 [6.9888]
 [7.9887]
 [8.9886]]
x^(3)= [[5.00045 ]
 [6.000449]
 [7.000448]
 [8.000447]
 [9.000446]]
```
```
x^(4)= [[4.9999821 ]
 [5.99998209]
 [6.99998208]
 [7.99998207]
 [8.99998206]]
x^(5)= [[5.00000072]
 [6.00000072]
 [7.00000072]
 [8.00000072]
 [9.00000072]]
x^(6)= [[4.99999997]
 [5.99999997]
 [6.99999997]
 [7.99999997]
 [8.99999997]]
x^(7)= [[5.]
 [6.]
 [7.]
 [8.]
 [9.]]
x^(8)= [[5.]
 [6.]
 [7.]
 [8.]
 [9.]]
x^(9)= [[5.]
 [6.]
 [7.]
 [8.]
 [9.]]
```
= –ó–∞–¥–∞—á–∞ –ö–æ—à–∏ –º–µ—Ç–æ–¥–∞–º–∏ –≠–π–ª–µ—Ä–∞

*–£—Å–ª–æ–≤–∏–µ* 

–†–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –ö–æ—à–∏: a) –º–µ—Ç–æ–¥–æ–º –≠–π–ª–µ—Ä–∞; –±) —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –≠–π–ª–µ—Ä–∞: $ùë¶‚Ä≤ = 2 ‚ãÖ ùëâ ‚ãÖ ùë• + ùëâ ‚ãÖ ùë•^2 ‚àí ùë¶, ùë¶(x_0) = ùëâ ‚ãÖ ùë•^2$.

*–ö–æ–¥*

```python
import numpy as np
import pandas as pd 
def f(x, y, V=5):
    return 2 * V * x + V * x**2 - y
# –ú–µ—Ç–æ–¥ –≠–π–ª–µ—Ä–∞ 
def euler_method(x0, y0, h, n, V):
    x = np.zeros(n + 1)
    y = np.zeros(n + 1)
    x[0] = x0
    y[0] = y0
    for i in range(n):
        x[i + 1] = x[i] + h
        y[i + 1] = y[i] + h * f(x[i], y[i], V)
    return x, y
```
```
# –£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≠–π–ª–µ—Ä–∞ 
def improved_euler_method(x0, y0, h, n, V):
    x = np.zeros(n + 1)
    y = np.zeros(n + 1)
    x[0] = x0
    y[0] = y0 
    for i in range(n):
        x[i + 1] = x[i] + h
        y_half = y[i] + (h / 2) * f(x[i], y[i], V)
        x_half = x[i] + h / 2
        y[i + 1] = y[i] + h * f(x_half, y_half, V)
    return x, y
def exact_solution(x, V=5):
    return V * x**2
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
x0 = 1
V = y0 = 5
h = 0.001 # —à–∞–≥
n = 10
# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π
x_euler, y_euler = euler_method(x0, y0, h, n, V)
x_improved, y_improved = improved_euler_method(x0, y0, h, n, V)
y_exact = exact_solution(x_euler)
# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–µ–π
error_euler = np.abs(y_euler - y_exact)
error_improved = np.abs(y_improved - y_exact)
print("\n–ú–µ—Ç–æ–¥ –≠–π–ª–µ—Ä–∞: ")
print("-" * 130)
print("x:      ", " ".join(f"{x:>10.7f}" for x in x_euler))
print("y_M:    ", " ".join(f"{y:>10.7f}" for y in y_euler))
print("y_T:    ", " ".join(f"{y:>10.7f}" for y in y_exact))
print("–ü–æ–≥—Ä–µ—à–Ω:", " ".join(f"{e:>10.7f}" for e in error_euler))
print("-" * 130)
print("\n–£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≠–π–ª–µ—Ä–∞: ")
print("-" * 130)
print("x:      ", " ".join(f"{x:>10.7f}" for x in x_improved))
print("y_M:    ", " ".join(f"{y:>10.7f}" for y in y_improved))
print("y_T:    ", " ".join(f"{y:>10.7f}" for y in y_exact))
print("–ü–æ–≥—Ä–µ—à–Ω:", " ".join(f"{e:>10.7f}" for e in error_improved))
print("-" * 130)
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç*
#image("image_task8.png")

= –ö—Ä–∞–µ–≤–∞—è –∑–∞–¥–∞—á–∞ —Ä–∞–∑–Ω–æ—Å—Ç–Ω—ã–º –º–µ—Ç–æ–¥–æ–º

*–£—Å–ª–æ–≤–∏–µ* 

–†–µ—à–∏—Ç—å –∫—Ä–∞–µ–≤—É—é –∑–∞–¥–∞—á—É —Ä–∞–∑–Ω–æ—Å—Ç–Ω—ã–º –º–µ—Ç–æ–¥–æ–º. 
#align(center)[
  $
  cases(
    y'' + x^2y' + x y = 4 V x^4 - 3 V T x^3 + 6 V x -  2 V T, \
    y'(0) = y(T) = 0, \
    V = T = 5 - text("–í–∞—Ä–∏–∞–Ω—Ç")
  )
  $
]

```python
V = 5 # –Ω–æ–º–µ—Ä –≤–∞—Ä–∞–Ω—Ç–∞
def derivative(x):
    return -(4 * V * x**4 - 3 * V**2 * x**3 + 6 * V * x - 2 * V**2)
def Y(x):
    return V * x**2 * (x - V)
def p(x):
    return -x**2
def q(x):
    return -x
def main():
    n = 10
    x0 = 0
    h = V / n
    x = [x0 + i * h for i in range(n + 1)]
    exact = [Y(xi) for xi in x]
    f = [0.0] * (n + 1)
    s = [0.0] * (n + 1)
    t = [0.0] * (n + 1)
    r = [0.0] * (n + 1)
    f1 = [0.0] * (n + 1)
    s1 = [0.0] * (n + 1)
    y = [0.0] * (n + 1)
    e = [0.0] * (n + 1)
    for i in range(1, n):
        f[i] = 0.5 * (1 + 0.5 * h * p(x[i]))
        s[i] = 0.5 * (1 - 0.5 * h * p(x[i]))
        t[i] = 1 + 0.5 * h**2 * q(x[i])
        r[i] = 0.5 * h**2 * derivative(x[i])
    f1[1] = 0.0
    s1[1] = 0.0
    for j in range(1, n):
        denom = t[j] - f[j] * f1[j]
        f1[j + 1] = s[j] / denom
        s1[j + 1] = (r[j] + f[j] * s1[j]) / denom
    # –ì—Ä–∞–Ω–∏—á–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ y[n] = 0 –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ –Ω–µ—è–≤–Ω–æ, –ø—Ä–∏–Ω–∏–º–∞–µ–º y[n]=0
    y[n] = 0.0
    for j in range(n - 1, 0, -1):
        y[j] = f1[j + 1] * y[j + 1] + s1[j + 1]
    max_e = 0.0
    max_e_index = 0
    for i in range(n + 1):
        e[i] = abs(y[i] - exact[i])
        if (e[i] > max_e):
            max_e = e[i]
            max_e_index = i
    print("x\t y\t\t exact\t e")
    for i in range(n + 1):
        print(f"{x[i]:.2f}\t {y[i]:.2f} \t{exact[i]:.2f}\t {e[i]:.8f}")
    print("–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π e: ", max_e, "–ù–æ–º–µ—Ä –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –µ: ", max_e_index)
if __name__ == "__main__":
    main()
```

*–†–µ–∑—É–ª—å—Ç–∞—Ç*

```
x          y            exact           e
0.00      0.00          -0.00       0.00000000
0.50     -0.09          -5.62       5.53017248
1.00     -10.31         -20.00      9.68559849
1.50     -29.38         -39.38      9.99173440
2.00     -52.77         -60.00      7.22943620
2.50     -73.33         -78.12      4.79707715
3.00     -86.60         -90.00      3.39879569
3.50     -89.59         -91.88      2.28687417
4.00     -78.58         -80.00      1.41652296
4.50     -49.97         -50.62      0.65542909
5.00      0.00            0.00      0.00000000
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π e: 9.991734404070492 
–ù–æ–º–µ—Ä –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –µ: 3
```

= –ö—Ä–∞–µ–≤–∞—è –∑–∞–¥–∞—á–∞ –º–µ—Ç–æ–¥–æ–º –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
#align(center)[
  $
  cases(
    y'' + x^2y' + x y = 4 V x^4 - 3 V T x^3 + 6 V x -  2 V T, \
    y'(0) = y(T) = 0, \
    V = T = 5 - text("–í–∞—Ä–∏–∞–Ω—Ç")
  )
  $
]

*–ö–æ–¥*
```python 
import numpy as np
V = 5 # –Ω–æ–º–µ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞
h = 0.1 # —à–∞–≥
n = int(V / h)
maxx = V
# y —Ç–æ—á–Ω—ã–π
def ytoch(x):
    return V * x * x * (x - maxx)
def f(x):
    return 4 * V * (x ** 4) - 3 * V * V * (x ** 3) + 6 * V * x - 2 * V * V
def p(x):
    return x * x
def q(x):
    return x
def phi_k(x, k):
    return x ** k * (x - V)
def dphi_k(x, k):
    return (k + 1) * x ** k - V * k * x ** (k - 1)
def ddphi_k(x, k):
    return k * (k + 1) * x ** (k - 1) - V * k * (k - 1) * x ** (k - 2)
# –°–æ–∑–¥–∞–µ–º —Å–µ—Ç–∫—É
xk = [x * h for x in range(n + 1)]
ykToch = [ytoch(x) for x in xk]
print("–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –≤ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–∫–∞—Ö:")
test_points = [0, 1, 2, 3, 4, 5]
for x in test_points:
    print(f"x = {x}: y_toch = {ytoch(x):.2f}")
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã A –∏ –≤–µ–∫—Ç–æ—Ä–∞ b
A = np.zeros((n, n))
b = np.zeros(n)
# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã A –∏ –≤–µ–∫—Ç–æ—Ä–∞ b –¥–ª—è –í–ù–£–¢–†–ï–ù–ù–ò–• —Ç–æ—á–µ–∫ (i=1..n-1)
for i in range(1, n + 1):
    b[i - 1] = f(xk[i])
    for k in range(1, n + 1):
        A[i - 1][k - 1] = ddphi_k(xk[i], k) + p(xk[i]) * dphi_k(xk[i], k) + q(xk[i]) * phi_k(xk[i], k)
```
```
print(f"\n–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã A: {A.shape}")
print(f"–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ b: {b.shape}")
# –ú–µ—Ç–æ–¥ –ì–∞—É—Å—Å–∞ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –°–õ–ê–£ A * c = b
def gauss_elimination(A, b):
    n = len(b)
    # –ü—Ä—è–º–æ–π —Ö–æ–¥ –º–µ—Ç–æ–¥–∞ –ì–∞—É—Å—Å–∞
    for i in range(n):
        # –ü–æ–∏—Å–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å—Ç–æ–ª–±—Ü–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
        max_row = i
        max_val = abs(A[i, i])
        for j in range(i + 1, n):
            if abs(A[j, i]) > max_val:
                max_val = abs(A[j, i])
                max_row = j
        # –û–±–º–µ–Ω —Å—Ç—Ä–æ–∫, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
        if max_row != i:
            A[[i, max_row]] = A[[max_row, i]]
            b[i], b[max_row] = b[max_row], b[i]
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω—É–ª–µ–≤–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        if abs(A[i, i]) < 1e-12:
            print(f"–í–Ω–∏–º–∞–Ω–∏–µ: –º–∞–ª—ã–π –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç A[{i},{i}] = {A[i, i]}")
            A[i, i] = 1e-12
        # –ù–æ—Ä–º–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫–∏
        pivot = A[i, i]
        for j in range(i, n):
            A[i, j] /= pivot
        b[i] /= pivot
        # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–∑ –Ω–∏–∂–µ–ª–µ–∂–∞—â–∏—Ö —Å—Ç—Ä–æ–∫
        for j in range(i + 1, n):
            factor = A[j, i]
            for k in range(i, n):
                A[j, k] -= factor * A[i, k]
            b[j] -= factor * b[i]
    # –û–±—Ä–∞—Ç–Ω—ã–π —Ö–æ–¥ –º–µ—Ç–æ–¥–∞ –ì–∞—É—Å—Å–∞
    c = np.zeros(n)
    for i in range(n - 1, -1, -1):
        c[i] = b[i]
        for j in range(i + 1, n):
            c[i] -= A[i, j] * c[j]
    return c
# –†–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
print("\n–†–µ—à–µ–Ω–∏–µ –°–õ–ê–£ –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å—Å–∞")
c = gauss_elimination(A.copy(), b.copy())
print("\n–ü–µ—Ä–≤—ã–µ 10 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ a_k:")
for i in range(min(10, len(c))):
    print(f"a_{i+1} = {c[i]:.6e}")
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
def y_approx(x, c):
    result = 0
    for k in range(1, len(c) + 1):
        result += c[k - 1] * phi_k(x, k)
    return result
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ–≥–æ –∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏–π
print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–æ—á–∫–∞—Ö:")
print("x\t\t–¢–æ—á–Ω–æ–µ y\t–ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ y\t\t–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å")
for x in range(V + 1):
    y_exact = ytoch(x)
    y_appr = y_approx(x, c)
    rel_error = abs((y_appr - y_exact) / y_exact) if abs(y_exact) > 1e-12 else abs(y_appr)
    print(f"{x}\t\t{y_exact:.4f}\t\t{y_appr:.4f}\t\t{rel_error:.2e}")
```

*–†–µ–∑—É–ª—å—Ç–∞—Ç*

```
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –≤ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–∫–∞—Ö:
x = 0: y_toch = 0.00
x = 1: y_toch = -20.00
x = 2: y_toch = -60.00
x = 3: y_toch = -90.00
x = 4: y_toch = -80.00
x = 5: y_toch = 0.00
–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã A: (50, 50)
–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ b: (50,)
–†–µ—à–µ–Ω–∏–µ –°–õ–ê–£ –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å—Å–∞
–ü–µ—Ä–≤—ã–µ 10 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ a_k:
a_1 = 1.507017e-12
a_2 = 5.000000e+00
a_3 = 2.660881e-10
a_4 = -1.744293e-09
a_5 = 7.754601e-09
a_6 = -2.451899e-08
a_7 = 5.696992e-08
a_8 = -9.949613e-08
a_9 = 1.324989e-07
a_10 = -1.354025e-07
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–æ—á–∫–∞—Ö:
x               –¢–æ—á–Ω–æ–µ y        –ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ y          –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
0                0.0000             0.0000                    0.00e+00
1               -20.0000           -20.0000                   2.84e-14
2               -60.0000           -60.0000                   3.67e-15
3               -90.0000           -90.0000                   4.74e-16
4               -80.0000           -80.0000                   1.78e-16
5                0.0000             0.0000                    0.00e+00
```

= –†–µ—à–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è

*–£—Å–ª–æ–≤–∏–µ*

–†–µ—à–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ:
$ y(x) + 1 * integral_0^1 (x t + x^2 t^2 + x^3 t^3) y(t) d t
  = V (4/3 x + 1/4 x^2 + 1/5 x^3) $

```python 
import numpy as np
import pandas as pd
from scipy.integrate import quad
from scipy.linalg import solve
def solve_fredholm_degenerate_correct(V):
    a, b = 0, 1
    n = 3
    lam = 1
    def y_exact(x):
        return V * x
    def f(x):
        return V * (4 / 3 * x + 1 / 4 * x**2 + 1 / 5 * x**3)
    a_funcs = [lambda x: x, lambda x: x**2, lambda x: x**3]
    b_funcs = [lambda t: t, lambda t: t**2, lambda t: t**3]
    alpha = np.zeros((n, n))
    gamma = np.zeros(n)
    for i in range(n):
        for k in range(n):
            alpha[i, k], _ = quad(lambda x: a_funcs[i](x) * b_funcs[k](x), a, b)
        gamma[i], _ = quad(lambda x: f(x) * b_funcs[i](x), a, b)
```
```
    A = np.eye(n) + lam * alpha.T
    q = solve(A, gamma)
    def y_numerical(x):
        result = f(x)
        for i in range(n):
            result -= lam * q[i] * a_funcs[i](x)
        return result
    x_test = np.linspace(a, b, 10)
    y_num_vals = [y_numerical(x) for x in x_test]
    y_ex_vals = [y_exact(x) for x in x_test]
    errors = [abs(y_num_vals[i] - y_ex_vals[i]) for i in range(len(x_test))]
    df = pd.DataFrame(
        {"x": x_test, "y_–º–µ—Ç–æ–¥–∞": y_num_vals, "y_—Ç–æ—á–Ω": y_ex_vals, "eps": errors}
    )
    print(df.to_string(index=False))
    print("\n")
    return y_numerical, y_exact
if __name__ == "__main__":
    V = 5  # –Ω–æ–º–µ—Ä –≤–∞—Ä–∞–Ω—Ç–∞
    solve_fredholm_degenerate_correct(V)
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç*
```
    x       y_–º–µ—Ç–æ–¥–∞    y_—Ç–æ—á–Ω        eps
0.000000    0.000000   0.000000   0.000000e+00
0.111111    0.555556   0.555556   1.110223e-16
0.222222    1.111111   1.111111   0.000000e+00
0.333333    1.666667   1.666667   2.220446e-16
0.444444    2.222222   2.222222   0.000000e+00
0.555556    2.777778   2.777778   4.440892e-16
0.666667    3.333333   3.333333   1.332268e-15
0.777778    3.888889   3.888889   0.000000e+00
0.888889    4.444444   4.444444   0.000000e+00
1.000000    5.000000   5.000000   0.000000e+00
```